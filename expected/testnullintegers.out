/**************** Null return test functions ***************************/
CREATE OR REPLACE FUNCTION returnNullInt() RETURNS integer AS $$
return null;
$$ LANGUAGE pldotnet;
SELECT returnNullInt();
 returnnullint 
---------------
              
(1 row)

CREATE OR REPLACE FUNCTION returnNullSmallInt() RETURNS smallint AS $$
return null;
$$ LANGUAGE pldotnet;
SELECT returnNullSmallInt();
 returnnullsmallint 
--------------------
                   
(1 row)

CREATE OR REPLACE FUNCTION returnNullBigInt() RETURNS bigint AS $$
return null;
$$ LANGUAGE pldotnet;
SELECT returnNullBigInt();
 returnnullbigint 
------------------
                 
(1 row)

/**************** Null operations test functions ***************************/
CREATE OR REPLACE FUNCTION sumNullArgInt(a integer, b integer) RETURNS integer AS $$
return a + b;
$$
LANGUAGE pldotnet;
SELECT sumNullArgInt(null,null);
 sumnullargint 
---------------
              
(1 row)

SELECT sumNullArgInt(null,3);
 sumnullargint 
---------------
              
(1 row)

SELECT sumNullArgInt(3,null);
 sumnullargint 
---------------
              
(1 row)

SELECT sumNullArgInt(3,3);
 sumnullargint 
---------------
             6
(1 row)

CREATE OR REPLACE FUNCTION sumNullArgSmallInt(a smallint, b smallint) RETURNS smallint AS $$
return (short?)(a + b);
$$
LANGUAGE pldotnet;
SELECT sumNullArgSmallInt(null,null);
 sumnullargsmallint 
--------------------
                   
(1 row)

SELECT sumNullArgSmallInt(null,CAST(101 AS smallint));
 sumnullargsmallint 
--------------------
                   
(1 row)

SELECT sumNullArgSmallInt(CAST(101 AS smallint),null);
 sumnullargsmallint 
--------------------
                   
(1 row)

SELECT sumNullArgSmallInt(CAST(101 AS smallint),CAST(101 AS smallint));
 sumnullargsmallint 
--------------------
                202
(1 row)

CREATE OR REPLACE FUNCTION sumNullArgBigInt(a bigint, b bigint) RETURNS bigint AS $$
return a + b;
$$
LANGUAGE pldotnet;
SELECT sumNullArgBigInt(null,null);
 sumnullargbigint 
------------------
                 
(1 row)

SELECT sumNullArgBigInt(null,100);
 sumnullargbigint 
------------------
                 
(1 row)

SELECT sumNullArgBigInt(9223372036854775707,null);
 sumnullargbigint 
------------------
                 
(1 row)

SELECT sumNullArgBigInt(9223372036854775707,100);
  sumnullargbigint   
---------------------
 9223372036854775807
(1 row)

/**************** Conditional return test functions ***************************/
CREATE OR REPLACE FUNCTION checkedSumNullArgInt(a integer, b integer) RETURNS integer AS $$
if(!a.HasValue || !b.HasValue)
    return null;
else
    return a + b;
$$
LANGUAGE pldotnet;
SELECT checkedSumNullArgInt(null,null);
 checkedsumnullargint 
----------------------
                     
(1 row)

SELECT checkedSumNullArgInt(null,3);
 checkedsumnullargint 
----------------------
                     
(1 row)

SELECT checkedSumNullArgInt(3,null);
 checkedsumnullargint 
----------------------
                     
(1 row)

SELECT checkedSumNullArgInt(3,3);
 checkedsumnullargint 
----------------------
                    6
(1 row)

CREATE OR REPLACE FUNCTION checkedSumNullArgSmallInt(a smallint, b smallint) RETURNS smallint AS $$
if(!a.HasValue || !b.HasValue)
    return null;
else
    return (short?)(a + b);
$$
LANGUAGE pldotnet;
SELECT checkedSumNullArgSmallInt(null,null);
 checkedsumnullargsmallint 
---------------------------
                          
(1 row)

SELECT checkedSumNullArgSmallInt(null,CAST(133 AS smallint));
 checkedsumnullargsmallint 
---------------------------
                          
(1 row)

SELECT checkedSumNullArgSmallInt(CAST(133 AS smallint),null);
 checkedsumnullargsmallint 
---------------------------
                          
(1 row)

SELECT checkedSumNullArgSmallInt(CAST(133 AS smallint),CAST(133 AS smallint));
 checkedsumnullargsmallint 
---------------------------
                       266
(1 row)

CREATE OR REPLACE FUNCTION checkedSumNullArgBigInt(a bigint, b bigint) RETURNS bigint AS $$
if(!a.HasValue || !b.HasValue)
    return null;
else
    return a + b;
$$
LANGUAGE pldotnet;
SELECT checkedSumNullArgBigInt(null,null);
 checkedsumnullargbigint 
-------------------------
                        
(1 row)

SELECT checkedSumNullArgBigInt(null,100);
 checkedsumnullargbigint 
-------------------------
                        
(1 row)

SELECT checkedSumNullArgBigInt(9223372036854775707,null);
 checkedsumnullargbigint 
-------------------------
                        
(1 row)

SELECT checkedSumNullArgBigInt(9223372036854775707,100);
 checkedsumnullargbigint 
-------------------------
     9223372036854775807
(1 row)

/**************** Conditional return test functions (Mixed Args)  ***************************/
CREATE OR REPLACE FUNCTION checkedSumNullArgMixed(a integer, b smallint, c bigint) RETURNS bigint AS $$
if(!a.HasValue || !b.HasValue || !c.HasValue)
    return null;
else
    return (long)a + (long)b + c;
$$
LANGUAGE pldotnet;
SELECT checkedSumNullArgMixed(null,null,null);
 checkedsumnullargmixed 
------------------------
                       
(1 row)

SELECT checkedSumNullArgMixed(null,CAST(1313 as smallint),null);
 checkedsumnullargmixed 
------------------------
                       
(1 row)

SELECT checkedSumNullArgMixed(1313,null,null);
 checkedsumnullargmixed 
------------------------
                       
(1 row)

SELECT checkedSumNullArgMixed(null,null,3);
 checkedsumnullargmixed 
------------------------
                       
(1 row)

SELECT checkedSumNullArgMixed(1313,CAST(1313 as smallint), 1313);
 checkedsumnullargmixed 
------------------------
                   3939
(1 row)

